### --- SECTION 1: METADATA OVERRIDES --- ###
# Fixes hostnames for syslog data where the relay's IP is incorrectly used as the host
[force_host_for_syslog]
DEST_KEY = MetaData:Host
REGEX = \s(\w[-_a-zA-Z0-9]+)\s(?:%[A-Z_-]+)
FORMAT = host::$1

# Dynamically change sourcetype for Cisco ASA logs coming in via generic syslog
[force_sourcetype_cisco_asa]
DEST_KEY = MetaData:Sourcetype
REGEX = %ASA-\d-\d+
FORMAT = sourcetype::cisco:asa


### --- SECTION 2: DATA MASKING (PII/SENSITIVE) --- ###
# Masks 16-digit credit card numbers in raw data
[mask_credit_cards]
DEST_KEY = _raw
REGEX = (\d{4}-?){3}(\d{4})
FORMAT = $1xxxx-xxxx-xxxx-$2
REPEAT_MATCH = true


### --- SECTION 3: DATA ROUTING & FILTERING --- ###
# Drops 'DEBUG' level logs to save license volume
[drop_debug_logs]
DEST_KEY = queue
REGEX = \sDEBUG\s
FORMAT = nullQueue

# Routes specific security events to a high-retention index
[route_security_to_audit_index]
DEST_KEY = _MetaData:Index
REGEX = (Failed\sLogin|Access\sDenied)
FORMAT = security_audit_logs


### --- SECTION 4: ADVANCED EXTRACTIONS --- ###
# Extracts fields from a comma-separated custom app log
[extract_custom_app_fields]
DELIMS = ","
FIELDS = timestamp, user_id, action, status, response_time


### --- SECTION 5: LOOKUP DEFINITIONS --- ###
# Defines a lookup table for mapping error codes to descriptions
[error_code_lookup]
filename = error_codes.csv
